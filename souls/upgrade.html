<!DOCTYPE html>
<html>
<head>
    <title>Upgrade Stats</title>
    <style>
        body {
            font-family: "Garamond", Times, serif;
            background-color: black;
            color: white;
            animation: fadeIn 2s;
        }
        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .menu {
            background-color: #111;
            border: 1px solid #444;
            padding: 20px;
            border-radius: 5px;
        }
        .attribute {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
        }
        .attribute label {
            width: 100px;
        }
        .attribute input {
            width: 50px;
        }
        button {
            background-color: #460000;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: "Garamond", Times, serif;
            font-size: 18px;
        }
        .button {
            background-color: transparent;
            border: none;
            color: white;
            text-align: center;
            font-family: "Garamond", Times, serif;
            font-size: 18px;
        }
        button:hover {
            background-color: #520000;
        }
        @keyframes fadeIn{
            from{
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="menu">
            <div id="attributes">
                <!-- Attribute inputs will be dynamically added here -->
            </div>
            <button id="upgradeButton">Upgrade</button>
            <button id="confirmButton" style="display: none;">Confirm</button>
        </div>
    </div>

    <script>
        const playerData = JSON.parse(localStorage.getItem('playerData'));
        const playerID = JSON.parse(localStorage.getItem('userID'));
        console.log(playerID);
        const attributesDiv = document.getElementById('attributes');
        const upgradeButton = document.getElementById('upgradeButton');
        const confirmButton = document.getElementById('confirmButton');
        
        if (playerData) {
            for (const attribute in playerData) {
                if (!['name', 'gender', 'age', 'class_name'].includes(attribute)) {
                    const attributeInput = document.createElement('div');
                    attributeInput.classList.add('attribute');
                    attributeInput.innerHTML = `
                        <label>${attribute}</label>
                        <input id="${attribute}" type="number" value="${playerData[attribute]}" min="${playerData[attribute]}" max="${playerData[attribute] + 5}">
                    `;
                    attributesDiv.appendChild(attributeInput);
                }
            }
        }

        let totalUpgrades = 0;

        upgradeButton.addEventListener('click', function() {
            const attributeInputs = attributesDiv.querySelectorAll('input');
            let total = 0;
            attributeInputs.forEach(input => {
                total += parseInt(input.value);
            });

            if (total < 5) {
                attributeInputs.forEach(input => {
                    input.removeAttribute('disabled');
                });
            } else {
                attributeInputs.forEach(input => {
                    input.setAttribute('disabled', 'true');
                });
                upgradeButton.style.display = 'none';
                confirmButton.style.display = 'block';
            }
        });
    
        confirmButton.addEventListener('click', function() {
            const upgradedData ={

            }
            const attributeInputs = attributesDiv.querySelectorAll('input');
            attributeInputs.forEach(input => {
                upgradedData[input.id] = parseInt(input.value);
            });
            console.log(upgradedData);
            alert(JSON.stringify(upgradedData));
            const upgradeData = {
                id: playerID,
                name: playerData.name,
                gender: playerData.gender,
                age: playerData.age,
                class_name: playerData.class_name,
                health: upgradedData.health,
                attack: upgradedData.attack,
                power: upgradedData.power,
                resistance: upgradedData.resistance 
            };
            //window.location.href = "/ramjiJarmi/souls/game.html";
            // Here you could save the upgraded data back to localStorage or send it to the server.
            const soulsCharEndpoint = `https://ramjijarmi.stu.nighthawkcodingsociety.com/soulsCharacterList`;
            
            const requestMethod = {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(upgradeData)
            }
        
            fetch(soulsCharEndpoint, requestMethod)
                .then(response => {
                    if(!response.ok){
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('PUT request successful:', data);
                    
                })
                .catch(error => {
                    console.error('Problem with PUT request:', error);
                });
                
        });
    </script>
</body>
</html>
